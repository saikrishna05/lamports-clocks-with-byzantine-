Make sure all the 4 classes are in the same folder (Mo.java, Message.java, Po.java, ThreadService.java)
How to compile:
javac *.java

Execution:
Java ThreadService.java


Note:
1.If you want to simululate arbitary failure, you need to change the flag value in ThreadService from NO to YES, it is not case sensitive.
2. Attaching a set of output values as excel sheet, since the output generated is tough to understand, the excel sheet is ordered based on MO's and PO's for easy understanding.